name: Run Tests
on:
  push:
    branches:
      - main
jobs:
  test:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        python: ["2.7", "3.5", "3.6", "3.9"]
        django: ["1.8", "1.11", "2.0", "2.1", "2.2"]
        exclude:
          - python: 2.7
            django: 2.0
          - python: 2.7
            django: 2.1
          - python: 2.7
            django: 2.2
    steps:
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ matrix.python }}
      - name: Install dependencies
        run: |
          pip install -U django==${{ matrix.django }}
          if [ "${{ matrix.python }}" == "3.9" ]; then pip install black; fi
      - name: Run tests
        run: python manage.py test
      - name: Check black formatting
        run: |
          if [ "${{ matrix.python }}" == "3.9" ]; then
            black --check zen_queries
          fi